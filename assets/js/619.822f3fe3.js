(window.webpackJsonp=window.webpackJsonp||[]).push([[619],{1094:function(t,e,a){"use strict";a.r(e);var s=a(14),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"_11-8-第二个例子-读和写"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-8-第二个例子-读和写"}},[t._v("#")]),t._v(" 11.8 第二个例子：读和写")]),t._v(" "),e("p",[t._v("读和写是软件中很普遍的行为，提起它们会立即想到读写文件、缓存（比如字节或字符串切片）、标准输入输出、标准错误以及网络连接、管道等等，或者读写我们的自定义类型。为了让代码尽可能通用，Go 采取了一致的方式来读写数据。")]),t._v(" "),e("p",[e("code",[t._v("io")]),t._v(" 包提供了用于读和写的接口 "),e("code",[t._v("io.Reader")]),t._v(" 和 "),e("code",[t._v("io.Writer")]),t._v("：")]),t._v(" "),e("div",{staticClass:"language-go extra-class"},[e("pre",{pre:!0,attrs:{class:"language-go"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" Reader "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Read")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("byte")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" err "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" Writer "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Write")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("byte")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" err "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("只要类型实现了读写接口，提供 "),e("code",[t._v("Read")]),t._v(" 和 "),e("code",[t._v("Write")]),t._v(" 方法，就可以从它读取数据，或向它写入数据。一个对象要是可读的，它必须实现 "),e("code",[t._v("io.Reader")]),t._v(" 接口，这个接口只有一个签名是 "),e("code",[t._v("Read(p []byte) (n int, err error)")]),t._v(" 的方法，它从调用它的对象上读取数据，并把读到的数据放入参数中的字节切片中，然后返回读取的字节数和一个 "),e("code",[t._v("error")]),t._v(" 对象，如果没有错误发生返回 "),e("code",[t._v("nil")]),t._v("，如果已经到达输入的尾端，会返回 "),e("code",[t._v('io.EOF("EOF")')]),t._v("，如果读取的过程中发生了错误，就会返回具体的错误信息。类似地，一个对象要是可写的，它必须实现 "),e("code",[t._v("io.Writer")]),t._v(" 接口，这个接口也只有一个签名是 "),e("code",[t._v("Write(p []byte) (n int, err error)")]),t._v(" 的方法，它将指定字节切片中的数据写入调用它的对象里，然后返回实际写入的字节数和一个 "),e("code",[t._v("error")]),t._v(" 对象（如果没有错误发生就是 "),e("code",[t._v("nil")]),t._v("）。")]),t._v(" "),e("p",[e("code",[t._v("io")]),t._v(" 包里的 "),e("code",[t._v("Readers")]),t._v(" 和 "),e("code",[t._v("Writers")]),t._v(" 都是不带缓冲的，"),e("code",[t._v("bufio")]),t._v(" 包里提供了对应的带缓冲的操作，在读写 "),e("code",[t._v("UTF-8")]),t._v(" 编码的文本文件时它们尤其有用。在"),e("RouterLink",{attrs:{to:"/the-way-to-go/12.0.html"}},[t._v("第 12 章")]),t._v("我们会看到很多在实战中使用它们的例子。")],1),t._v(" "),e("p",[t._v("在实际编程中尽可能的使用这些接口，会使程序变得更通用，可以在任何实现了这些接口的类型上使用读写方法。")]),t._v(" "),e("p",[t._v("例如一个 "),e("code",[t._v("JPEG")]),t._v(" 图形解码器，通过一个 "),e("code",[t._v("Reader")]),t._v(" 参数，它可以解码来自磁盘、网络连接或以 "),e("code",[t._v("gzip")]),t._v(" 压缩的 "),e("code",[t._v("HTTP")]),t._v(" 流中的 "),e("code",[t._v("JPEG")]),t._v(" 图形数据，或者其他任何实现了 "),e("code",[t._v("Reader")]),t._v(" 接口的对象。")]),t._v(" "),e("h2",{attrs:{id:"链接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#链接"}},[t._v("#")]),t._v(" 链接")]),t._v(" "),e("ul",[e("li",[e("RouterLink",{attrs:{to:"/the-way-to-go/directory.html"}},[t._v("目录")])],1),t._v(" "),e("li",[t._v("上一节："),e("RouterLink",{attrs:{to:"/the-way-to-go/11.7.html"}},[t._v("第一个例子：使用Sorter接口排序")])],1),t._v(" "),e("li",[t._v("下一节："),e("RouterLink",{attrs:{to:"/the-way-to-go/11.9.html"}},[t._v("空接口")])],1)])])}),[],!1,null,null,null);e.default=n.exports}}]);